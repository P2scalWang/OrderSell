<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÇ‡∏£‡∏Ñ‡πÑ‡∏ï</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #fd7e14;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Sarabun', sans-serif; background-color: var(--bg-color); color: #333; line-height: 1.6; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; }
        
        header { text-align: center; margin-bottom: 25px; }
        header h1 { color: var(--primary-color); font-size: 1.5rem; }

        .card { background: var(--card-bg); border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); padding: 20px; margin-bottom: 20px; border-left: 5px solid transparent; }
        .card h2 { font-size: 1.1rem; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        
        /* ‡∏™‡∏µ‡πÅ‡∏ñ‡∏ö‡∏Ç‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î */
        .card.vital-signs { border-left-color: var(--success-color); }
        .card.sugar-check { border-left-color: var(--danger-color); }
        .card.weight-control { border-left-color: var(--warning-color); }
        .card.kidney-care { border-left-color: var(--primary-color); }

        .form-group { margin-bottom: 15px; }
        .form-row { display: flex; gap: 15px; }
        .col { flex: 1; }
        
        label { display: block; margin-bottom: 5px; font-weight: 500; font-size: 0.9rem; color: #555; }
        
        /* ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
        input[type="number"], input[type="date"], input[type="text"] {
            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; font-family: 'Sarabun', sans-serif;
            text-align: center;
        }
        /* ‡∏ñ‡πâ‡∏≤‡∏ä‡πà‡∏≠‡∏á‡πÑ‡∏´‡∏ô required ‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏Å ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡πÅ‡∏î‡∏á‡∏à‡∏≤‡∏á‡πÜ ‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ */
        input:invalid { border-color: #ffcccc; }
        input:focus { outline: none; border-color: var(--primary-color); }

        .input-wrapper { position: relative; }
        .unit { position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #888; font-size: 0.85rem; }

        .bp-group { display: flex; align-items: center; gap: 5px; }
        .bp-slash { font-size: 1.2rem; color: #888; font-weight: bold; }

        .radio-group { display: flex; gap: 15px; flex-wrap: wrap; }
        .radio-label { display: flex; align-items: center; gap: 5px; cursor: pointer; }

        .btn-save {
            width: 100%; padding: 15px; background-color: var(--primary-color); color: white;
            border: none; border-radius: 50px; font-size: 1.1rem; font-weight: bold; cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3); transition: all 0.2s;
        }
        .btn-save:disabled { background-color: #ccc; cursor: not-allowed; }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5); display: none;
            justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-box {
            background: white; padding: 30px; border-radius: 20px; text-align: center;
            width: 85%; max-width: 350px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); animation: popIn 0.3s ease;
        }
        .success-icon { font-size: 4rem; margin-bottom: 10px; display: block; }
        .modal-btn {
            background: var(--success-color); color: white; border: none; padding: 10px 30px;
            border-radius: 50px; font-size: 1rem; margin-top: 20px; cursor: pointer; width: 100%;
        }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô</h1>
        <p style="font-size: 0.9rem; color: #777;">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÇ‡∏£‡∏Ñ‡πÑ‡∏ï</p>
    </header>

    <form id="healthForm">
        
        <div class="card vital-signs">
            <h2>‚ù§Ô∏è ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ä‡∏µ‡∏û (Vital Signs)</h2>
            <div class="form-row">
                <div class="col">
                    <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô (‡∏ö‡∏ô / ‡∏•‡πà‡∏≤‡∏á) <span style="color:red">*</span></label>
                    <div class="bp-group">
                        <input type="number" id="bp_sys" placeholder="120" required>
                        <span class="bp-slash">/</span>
                        <input type="number" id="bp_dia" placeholder="80" required>
                    </div>
                </div>
                <div class="col">
                    <label>‡∏ä‡∏µ‡∏û‡∏à‡∏£ <span style="color:red">*</span></label>
                    <div class="input-wrapper">
                        <input type="number" id="pulse" placeholder="0" required>
                        <span class="unit">‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ</span>
                    </div>
                </div>
            </div>
            <div class="form-group" style="margin-top: 15px;">
                <label>‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÄ‡∏à‡∏ô‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î (SpO2) <span style="color:red">*</span></label>
                <div class="input-wrapper">
                    <input type="number" id="spo2" placeholder="95-100" required>
                    <span class="unit">%</span>
                </div>
            </div>
        </div>

        <div class="card sugar-check">
            <h2>üç¨ ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• (DTX)</h2>
            <div class="form-group">
                <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡∏õ‡∏•‡∏≤‡∏¢‡∏ô‡∏¥‡πâ‡∏ß <span style="color:red">*</span></label>
                <div class="input-wrapper">
                    <input type="number" id="dtx" placeholder="0" required>
                    <span class="unit">mg/dL</span>
                </div>
            </div>
        </div>

        <div class="card weight-control">
            <h2>‚öñÔ∏è ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å</h2>
            <div class="form-group">
                <label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏ä‡πâ‡∏≤ (‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏±‡∏ö‡∏ñ‡πà‡∏≤‡∏¢) <span style="color:red">*</span></label>
                <div class="input-wrapper">
                    <input type="number" step="0.1" id="weight" placeholder="0.0" required>
                    <span class="unit">‡∏Å‡∏Å.</span>
                </div>
            </div>
            
            <div class="form-group">
                <label>‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ö‡∏ß‡∏° (‡∏Å‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Ç‡πâ‡∏á) <span style="color:red">*</span></label>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="edema" value="no" checked> ‡πÑ‡∏°‡πà‡∏ö‡∏ß‡∏°
                    </label>
                    <label class="radio-label" style="color: var(--danger-color);">
                        <input type="radio" name="edema" value="yes"> ‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏ö‡∏∏‡πã‡∏°
                    </label>
                </div>
            </div>
        </div>

        <div class="card kidney-care">
            <h2>ü©∏ ‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÇ‡∏£‡∏Ñ‡πÑ‡∏ï</h2>
            <p style="font-size: 0.85rem; color: #888; margin-bottom: 15px;">*(‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≠‡∏ö‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)</p>
            
            <div class="form-group">
                <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï</label>
                <input type="date" id="dialysisDate">
            </div>

            <div class="form-group">
                <label>‡πÄ‡∏™‡πâ‡∏ô‡∏ü‡∏≠‡∏Å‡πÑ‡∏ï</label>
                <div class="radio-group">
                    <label class="radio-label" style="color: var(--success-color);">
                        <input type="radio" name="dialysis_line" value="have" checked> ‡∏°‡∏µ
                    </label>
                    <label class="radio-label" style="color: #666;">
                        <input type="radio" name="dialysis_line" value="none"> ‡πÑ‡∏°‡πà‡∏°‡∏µ
                    </label>
                </div>
            </div>
            
            <div class="form-group">
                <label>‡∏ô‡πâ‡∏≥‡∏î‡∏∂‡∏á‡∏≠‡∏≠‡∏Å (UF)</label>
                <div class="input-wrapper">
                    <input type="number" step="0.01" id="uf" placeholder="0.00">
                    <span class="unit">‡∏•‡∏¥‡∏ï‡∏£</span>
                </div>
            </div>
        </div>

        <button type="submit" id="submitBtn" class="btn-save">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button>
    </form>
</div>

<div id="successModal" class="modal-overlay">
    <div class="modal-box">
        <div class="success-icon">‚úÖ</div>
        <h2 style="color: var(--success-color); margin-bottom: 5px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h2>
        <p style="color: #666; font-size: 0.9rem;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
        <button class="modal-btn" onclick="closeModal()">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>
</div>

<script>
    const WEBHOOK_URL = 'https://script.google.com/macros/s/AKfycbyXgsayVTwvXM-DJh5GQhPgPDQW5IQjjIhTzG_jf_3tQnJrMxhdd4lVqbgizraZAck0yw/exec'; 

    const form = document.getElementById('healthForm');
    const submitBtn = document.getElementById('submitBtn');
    const modal = document.getElementById('successModal');

    function closeModal() {
        modal.style.display = 'none';
        form.reset();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    form.addEventListener('submit', function(e) {
        e.preventDefault();

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö (Validation) ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
        if (!form.checkValidity()) {
            form.reportValidity(); // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á ‡πÉ‡∏´‡πâ Browser ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏≠‡∏Å
            return;
        }

        const originalBtnText = submitBtn.innerText;
        submitBtn.innerText = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
        submitBtn.disabled = true;

        const sys = document.getElementById('bp_sys').value;
        const dia = document.getElementById('bp_dia').value;
        const combinedBP = `${sys}/${dia}`; 

        const formData = {
            timestamp: new Date().toISOString(),
            bp: combinedBP,
            bp_sys: sys,
            bp_dia: dia,
            pulse: document.getElementById('pulse').value,
            spo2: document.getElementById('spo2').value,
            dtx: document.getElementById('dtx').value,
            weight: document.getElementById('weight').value,
            edema: document.querySelector('input[name="edema"]:checked').value,

            // ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÑ‡∏ï: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á "" ‡πÑ‡∏õ
            dialysis_date: document.getElementById('dialysisDate').value,
            dialysis_line: document.querySelector('input[name="dialysis_line"]:checked') ? document.querySelector('input[name="dialysis_line"]:checked').value : "",
            uf: document.getElementById('uf').value
        };

        fetch(WEBHOOK_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
        })
        .then(response => {
            if (response.ok) {
                modal.style.display = 'flex';
            } else {
                alert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('‚ùå ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        })
        .finally(() => {
            submitBtn.innerText = originalBtnText;
            submitBtn.disabled = false;
        });
    });
</script>

</body>
</html>
